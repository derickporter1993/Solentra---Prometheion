# Elaro - AI Compliance Brain for Salesforce

## Project Overview
Elaro is an enterprise compliance automation platform for Salesforce that detects configuration drift, generates audit evidence, and provides intelligent compliance analysis for regulated organizations.

**Current Version:** v3.0 - Unified Enterprise Platform
**Status:** Production-ready (Grade: B+ 86/100)
**Primary Language:** Apex, Lightning Web Components (LWC), TypeScript

## Tech Stack
- **Platform:** Salesforce (API v65.0)
- **Backend:** Apex classes (207 deployed)
- **Frontend:** Lightning Web Components (34 active)
- **Database:** Custom Salesforce Objects (46 objects)
- **Testing:** Jest (LWC), Apex Test Classes
- **CI/CD:** GitHub Actions, CircleCI
- **Packaging:** AppExchange (managed package)

## Architecture
```
force-app/main/default/
├── classes/           # 207 Apex classes (security utils, compliance engines)
├── lwc/              # 34 Lightning Web Components
├── objects/          # 46 custom objects (compliance metadata)
├── triggers/         # Audit trail automation
└── staticresources/  # UI assets and libraries

platform/             # Node.js tooling
├── packages/types/   # TypeScript definitions
└── packages/masking/ # Data privacy utilities
```

## Key Capabilities
1. **Configuration Drift Detection** - Monitors Salesforce metadata changes
2. **Permission Intelligence** - Analyzes profile/permission set sprawl
3. **Audit Evidence Generation** - Automated compliance documentation
4. **Compliance Baseline Reports** - Regulatory-ready reporting
5. **Security-First Design** - All queries use WITH SECURITY_ENFORCED

## Development Guidelines

### Salesforce Commands
- Always use the SF CLI v2 syntax (`sf` not `sfdx`)
- Default org alias: `elaro-dev`
- Dev Hub: `prod-org`
- Scratch org config: `config/project-scratch-def.json`

### Code Standards
- **Security:** Use ElaroSecurityUtils for all CRUD/FLS checks
- **SOQL:** All queries MUST include `WITH SECURITY_ENFORCED`
- **Testing:** Minimum 75% code coverage (target: 85%+)
- **Naming:** Classes use ElaroXxx prefix
- **Documentation:** JSDoc for Apex, TSDoc for TypeScript

### Testing Strategy
- Run `npm run test:unit` before commits
- Run `sf apex run test` for Apex tests
- Maintain test data in `scripts/apex/sample-data/`
- Mock external integrations in tests

### Deployment
- **Never** deploy directly to production
- Use scratch orgs for feature development
- Deploy via: `sf project deploy start --target-org [alias]`
- Preview changes: `sf project deploy preview`

## Common Tasks

### Load Session Context
Use the custom command: `/sfcontext` to load current project status

### Create Scratch Org
```bash
sf org create scratch -f config/project-scratch-def.json -a elaro-scratch -d 30
sf project deploy start --target-org elaro-scratch
```

### Run Tests
```bash
sf apex run test --test-level RunLocalTests --target-org elaro-dev
npm run test:unit  # LWC tests
```

### Deploy Changes
```bash
sf project deploy preview --target-org elaro-dev
sf project deploy start --target-org elaro-dev
```

### Query Compliance Data
```bash
sf data query --query "SELECT Id, Name, Status__c FROM Elaro_Compliance_Rule__c" --target-org elaro-dev
```

## File Structure Priorities
When working with code:
1. **Critical Paths:**
   - `force-app/main/default/classes/` - Core business logic
   - `force-app/main/default/lwc/` - User interface components
   - `force-app/main/default/objects/` - Data model

2. **Documentation:**
   - `docs/SESSION_CONTEXT.md` - Current work tracking
   - `docs/architecture/` - System design docs
   - `docs/api/` - Integration documentation

3. **Configuration:**
   - `config/` - Salesforce org configs
   - `.claude/` - Claude Code settings
   - `sfdx-project.json` - Package manifest

## Important Constraints
- ❌ Never delete `force-app/`, `node_modules/`, or production scratch org
- ❌ Never deploy without running tests first
- ⚠️ Always check FLS/CRUD before SOQL/DML operations
- ⚠️ Hardcoded paths reference `/Users/derickporter/sentinel-code/` (legacy)
- ✅ Use relative paths when creating new code

## Current Focus Areas
1. **Permission Intelligence Engine** - Advanced permission analysis (see `docs/permission-intelligence-engine-prd.md`)
2. **Compliance Rule Library** - Expanding regulatory framework coverage
3. **AppExchange Packaging** - Preparing managed package release
4. **API Integrations** - External compliance tool connectors

## Session Handoff
At the end of each session, update `docs/SESSION_CONTEXT.md` with:
- Completed tasks
- Work in progress
- Blockers or issues
- Next recommended actions

---

**Questions?** Check `docs/` for detailed documentation or use `/sfcontext` to load current project state.
